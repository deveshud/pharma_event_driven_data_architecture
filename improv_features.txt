1. metadata pipelining across all layers